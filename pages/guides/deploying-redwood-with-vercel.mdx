import Guide from '~/components/layout/guide'
import Snippet from '~/components/snippet'
import Caption from '~/components/text/caption'
import Link from '~/components/text/link'
import Note from '~/components/text/note'
import { InlineCode } from '~/components/text/code'
import DeploySection from '~/components/guides/deploy-section'
import { PRODUCT_NAME } from '~/lib/constants'
import NameWrapper from '~/components/name/name-wrapper'

export const meta = {
  title: `Deploy RedwoodJS with ${PRODUCT_NAME}`,
  description: `Create a Redwood blog and deploy it live with ${PRODUCT_NAME}.`,
  published: '2020-08-18T12:00:00.860Z',
  authors: ['mcsdev'],
  url: '/guides/deploying-redwood-with-vercel',
  image: `https://og-image.now.sh/**Deploy%20RedwoodJS%20Apps**%20%3Cbr%2F%3E%20with%20Vercel.png?theme=light&md=1&fontSize=100px&images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg&images=https%3A%2F%2Fd33wubrfki0l68.cloudfront.net%2F492ed629970792d32ac857da0166a7d2308bad99%2F428b6%2Fimages%2Fdiecut.svg&widths=300&widths=350&heights=undefined&heights=350`,
  name: 'Redwood',
  type: 'app',
  env: ['DATABASE_URL', 'FILESTACK_API_KEY'],
  editUrl: 'pages/guides/deploying-redwood-with-vercel.mdx',
  example: 'https://github.com/redwoodjs/example-blog/tree/vercel-deploy',
  demo: 'https://redwoodjs-example-blog.vercel.app/',
  lastEdited: '2020-08-19T09:43:55.000Z',
}

[RedwoodJS](https://redwoodjs.com/) is an opinionated, full-stack, serverless web application framework that will allow you to build and deploy JAMstack applications with ease.

In this guide, you will discover how to create and deploy a Redwood blog to [Vercel](/), backed by a [PostgreSQL](https://www.postgresql.org/) database connection.

## Step 1: Creating Your Redwood App

Set up a new Redwood app by cloning the project template and moving into the project directory:

<Snippet
  dark
  text="git clone https://github.com/redwoodjs/example-blog.git && cd example-blog"
/>
<Caption>
  Initializing a Redwood app and moving into the project directory.
</Caption>

Install the project dependencies with [Yarn](https://yarnpkg.com/):

<Snippet dark text="yarn install" />
<Caption>Installing the project dependencies with Yarn.</Caption>

Create a local SQLite database and seed it with the provided blog posts:

<Snippet dark text="yarn redwood db up && yard redwood db seed" />
<Caption>Creating and seeding a local SQLite database.</Caption>

<Note>
  When importing the project to Vercel, you will need to add an environment
  variable with the name <InlineCode>DATABASE_URL</InlineCode>, this will hold
  the value of a supplied PostgreSQL connection string.
</Note>

Use the provided Redwood script to set Vercel as the deployment target:

<Snippet dark text="yarn redwood g deploy vercel" />
<Caption>Setting the the project deployment target to Vercel.</Caption>

Your Redwood app is now ready for local development with the following command:

<Snippet dark text="yarn redwood dev" />
<Caption>Running the Redwood app locally.</Caption>

## Step 2: Retrieving Environment Variable Values

When [importing the project](/docs/git-integrations) into Vercel, you will be provided with the option to specify [environment variables](/docs/build-step#environment-variables). Make sure to add a `DATABASE_URL` environment variable with the connection string used.

After adding the environment variables during the import process, you can manage them from the Vercel Dashboard. To keep them in sync with your local environment, use the following command:

<Snippet dark text="vercel env pull" />
<Caption>
  Pulling the latest environment variables set in the Vercel Dashboard.
</Caption>

<Note>
  You can find more information on using a database with Redwood in the{' '}
  <Link href="https://redwoodjs.com/docs/deploy#prisma-and-database">
    Redwood documentation
  </Link>
  .
</Note>

## Step 3: Deploy Your App with <NameWrapper name={PRODUCT_NAME} />

<DeploySection meta={meta} />

## Bonus: Learn More about Redwood

After deploying your Redwood app, learn more about how it works and dive deeper with the resources below:

- [Get started with Redwood via Tutorial](https://redwoodjs.com/tutorial/welcome-to-redwood).
- [Redwood Deployment Docs](https://redwoodjs.com/docs/deploy).
- [Need help? Try the Redwood Community Forums](https://community.redwoodjs.com).
- [Need stickers? Grab yourself some new ones, Redwood style](https://redwoodjs.com/stickers).

export default ({ children }) => <Guide meta={meta}>{children}</Guide>

export const config = {
  amp: 'hybrid',
}
